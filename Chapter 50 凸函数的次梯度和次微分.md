第五十章
凸函数的次梯度和次微分
在这一章中，我们考虑了凸函数理论的一些更深层的方面，这些方面在其领域的每一点上都不一定是可微的。需要一些渐变的替代品。幸运的是，对于凸函数，有这样一个概念，即子梯度。几何上，给定一个（适当的）凸函数f，x处的次梯度是垂直于（x，f（x））处函数的上图支持超平面的向量。x上的次微分f（x）到f是x上所有次梯度的集合。一个关键特性是f在x iff f（x）=fx上是可微的，其中fx是f在x上的梯度。另一个重要特性是（适当的）凸函数f在x iff 0 f（x）上达到最小值。发展这种更复杂的凸函数“微分”理论的主要动机是将拉格朗日框架扩展到不一定可微的凸函数。
经验表明，考虑扩展实值函数，即函数f:s→r−∞，+∞，其中s是rn的一个子集（通常是凸的），凸优化的适用性显著提高。这让人想起了在采用值度量理论的已遇到函数中所发生的事情，在这种情况下，自然会考虑将值+−∞作为v∞=0的最小化结果的函数。，对于我们
不收敛。例如，如果j（u，v）=u，并且我们有仿射约束任何固定的λ，那么最小化问题
在v=0的情况下，将u+λv最小化，
得出溶液U=−∞和V=0。
到目前为止，我们选择不考虑取−∞值的函数，而是考虑部分函数，但结果证明，接受取−∞值的函数很方便。
允许函数取值+∞也是处理部分函数的一种方便的替代方法。凸集的指示函数很好地说明了这种情况。
一千六百七十一

定义50.1.设c rn为rn的任何子集。c的指示功能ic是由

指示函数ic是集合c的特征函数χc的变体（定义为，如果u∈c，则χc（u）=1；如果u/∈c，则χc（u）=0）。Rockafella用δ（−c）表示指标函数ic，即δ（u_c）=ic（u）；见Rockafella[134]，第28页。
给出了一个偏函数f:rn→r−∞，通过设置f（u）=+∞如果u/∈dom（f），我们将偏函数f转化为一个总函数，其值为r−∞，+∞。不过，我们必须记住，这些函数实际上是部分函数，但是−∞和＋∞扮演着不同的角色。值f（x）=-∞表示使用最小化过程计算f（x）并未终止，但f（x）=+∞表示函数f在x处确实未定义。
凸函数f:s→r−∞，+∞的定义需要稍作修改以适应无穷大的值±∞。最清晰的定义使用了铭文的概念。
一个值得注意和非常有用的事实是优化问题
使j（u）最小化，服从u∈c，
式中，c是RN中的闭凸集，j是凸函数，可以用c的指示函数ic重写，as
最小化j（u）+ic（z），以u−z=0为准。
但j（u）+ic（z）是不可微的，即使j是，也迫使我们处理不可微的凸函数。
凸函数不一定是可微的，但是如果凸函数f在u处有一个有限值f（u）（也就是f（u）∈r），那么它在u处有一个单边方向导数，另一个重要的概念是次梯度的概念，当函数f在u上是不可微的。
在第50.1节中，我们介绍了扩展实值函数，这些函数也可以取值±∞。特别地，我们定义了适当的凸函数和凸函数的闭包。第50.2节定义了次梯度和次微分。我们在第50.3节和第50.4节中讨论了地下坡度的一些性质。特别是，我们将次梯度与单边方向导数联系起来。在第50.5节中，我们讨论了求适当凸函数最小值的问题，并给出了一些关于次微分的准则。在第50.6节中，我们将第49章中关于拉格朗日框架的结果推广到允许凸但不一定可微的目标函数和不等式约束的程序。事实上，可以说，扩展实值凸函数理论和本章发展的次梯度和次微分的概念构成了将拉格朗日框架扩展到不一定可微的凸函数所需的机制。
本章主要依赖于Rockafella[134]。本章的一些结果也在Bertsekas[16，19，17]中讨论。应该注意的是，Bertsekas已经开发了一个框架来讨论二元性，他称之为最小公共/最大交叉框架，简称mc/mc。虽然这个框架本身很优雅，也很有趣，但是Bertsekas依赖它来证明次微分的性质，这使得读者更难“跳进去”。
50.1扩展实值凸函数
我们通过设置
−∞<x<+∞，对于所有x∈r。
定义50.2.值函数。对于anya（total）函数x∈rn，我们认为f:rn→rf−∞（x）是，有限的∞ifis称为anf（x）∈r扩展实型（等价，f（x）=6±∞）。如果f（x）对所有x∈rn都是有限的，则函数f是有限的。
稍微调整定义39.5，给定函数f:rn→r−∞，+∞，f的上图是由
epi（f）=（x，y）∈rn+1 f（x）≤y。
见图50.1。
如果s是rn的非空子集，则f到s约束的上图定义为
epi（f s）=（x，y）∈rn+1 f（x）≤y，x∈s。
注意以下事实：
1.	对于任何x∈s，如果f（x）=−∞，那么epi（f）在rn+1中包含“垂直线”（x，y）y∈r。
2.	对于任何x∈s，如果f（x）∈r，则epi（f）包含rn+1中的射线（x，y）f（x）≤y。
3.	对于任意x∈s，如果f（x）=+∞，那么epi（f）不包含任何点（x，y），其中y∈r。
4.	对于Alliff f，我们有epi（f）=∅xcorresponds to the partial function undefined everywhere；∈rn。也就是说，f（x）=+∞

图50.1：让f:r→r−∞，+∞由f（x）=x3表示x∈r。其在r2中的图形是洋红色曲线，其上图是洋红色曲线与“上”该曲线的蓝色区域的结合。对于任何点x∈r，epi（f）包含从（x，x3）开始向上延伸的射线。
定义50.3.，+∞是凸的，在一个非空的子集tf是凹的，如果它的上图s是-nepif，我们简单地说是凸的（fs s），作为rn，a（total）函数的一个子集。函数f为凸函数（分别为frisnf+1凹函数：.参见图→开，如果
−50.2∞。功能
它是有限的、凸的和凹的。如果S=R仿射）。
定义50.4.给定任意函数f:rn→r−∞，+∞，f的有效域dom（f）由dom（f）=x∈rn（y∈r）（（x，y）∈epi（f））=x∈rn f（x）<+∞给出。
观察f的有效域包含向量x∈rn，使f（x）=-∞，但不包括向量x∈rn，使f（x）=+∞。
例50.1。上述事实由函数f:r→r−∞，+∞表示，其中

该功能的铭文如图50.3所示。根据定义dom（f）=[0，∞）。
如果f是凸函数，因为dom（f）是线性映射（投影）的epi（f）图像，所以它是凸函数。
y1，yby定义，2∈r使得epif（（fx 1s））≤对于任意y1和f（x2）≤y2是凸的iff，对于每个（x1，y1）λ，这样0（x2，y2）对于≤λx≤1，x1，我们有2∈s和
（1-λ）（x1，y1）+λ（x2，y2）=（（1-λ）x1+λx2，（1-λ）y1+λy2）∈epi（f_s），

图50.2：让f:r→r−∞，+∞由f（x）=x2表示x∈r。其在r2中的图形是洋红色曲线，其上图是洋红色曲线与“上”该曲线的蓝色区域的结合。注意，epi（f）是一个凸的r2集，因为连接任意两点的aqua线段包含在epigraph中。
也就是说（1-λ）x1+λx2∈s和
F（（1-λ）x1+λx2）≤（1-λ）y1+λy2。（）
因此，不清楚表达式（1s必须是凸的，f（（1−fλ（）XX11）+和−λxλ）F2f）（（xx<21））++，因为这些值可能是∞λf。条件（（x2）意味着。）有点尴尬，−∞，其中
因为它没有明确指代
为了执行−∞和＋∞的算术运算，我们采用以下约定：
α+（+∞）=+∞+α=+∞	−∞<α≤+∞
α+-∞=-∞+α=-∞	−∞≤α<+∞
α（+∞）=（+∞）α=+∞	0<α≤+∞
α（−∞）=（−∞）α=−∞	0<α≤+∞
α（+∞）=（+∞）α=-∞	−∞≤α≤0
α（−∞）=（−∞）α=+∞	−∞≤α<0
0（+∞）=（+∞）0=0−（-∞）=+∞	0（−∞）=（−∞）0=0
inf∅=+∞	SUP∅=−∞。
表达式+∞+（-∞）和−∞+（+∞）没有意义。
凸函数的以下特征很容易显示出来。
提案50.1.设c为rn的非空凸子集。

图50.3：凹函数f（x）=-x2的上图，如果x≥0且＋∞否则。
(1)	函数f:c→rn+∞在c iff上是凸的。
F（（1-λ）x+λy）≤（1-λ）f（x）+λf（y）
对于所有x，y∈c和所有λ，使0<λ<1。
(2)	函数f:rn→rn−∞，+∞是凸iff
F（（1-λ）x+λy）<（1-λ）α+λβ
对于所有α，β∈r，所有x，y∈rn，使f（x）<α和f（y）<β，并且所有λ使0<λ<1。
下面定义了我们要处理的“好”凸函数。
定义50.5.凸函数f:rn→r−∞，+∞是适当的，如果它的铭文是非空的并且不包含任何垂直线。等价地，如果f（x）-∞对于所有x∈rn，f（x）<+∞对于某些x∈rn，f是适当的。不正确的函数称为不正确的函数。
如果f对dom（f）的限制是有限函数，则观察凸函数f是否合适。
立即证明了集C是凸的，只要它的指示函数IC是凸的，显然凸集的指示函数是适当的。
研究的重要对象是一组适当的函数，但不能避免不适当的函数。
例50.2。下面是一个不适当凸函数的例子f:r→r−∞，+∞：
−∞如果x<1 f（x）=0如果x=1
+∞如果x>1
观察dom（f）=[-1,1]，并且epi（f）未关闭。见图50.4。

图50.4：实施例50.2的不当凸函数及其上图描绘为R2的玫瑰色区域。
上图闭合的函数往往具有更好的特性。为了描述这些函数，我们引入了子级集。
定义50.6.给定函数f:rn→r−∞，+∞，任意α∈r−∞，+∞，
子级集合subsevα（f）和subsev<α（f）是集合
亚组vα（f）=x∈rn f（x）≤α和亚组v<α（f）=x∈rn f（x）<α。
对于例50.2中的不适当凸函数，我们得到了亚单位v−∞（f）=（−1,1），而亚单位v−∞（f）=∅。当−∞<α<0时，亚单位α（f）=（−1,1）=Sublv<α（f）。subsev0（f）=[-1,1]，而subsev<0（f）=（-1,1）。
当0<α<+∞时，次分Vα（f）=[−1,1]=次分V<α（f）。
次分V+∞（f）=R，而次分V<+∞（f）=[−1,1]。
命题50.1的一个有用推论是以下结果，其（简单）证明可在Rockafella[134]中找到（定理4.6）。
提案50.2.如果f是RN上的任何凸函数，那么对于每个α∈r−∞，+∞，子级集合subsevα（f）和subsev<α（f）都是凸的。
定义50.7.如果子级集合所有α∈r的子级α（f）=x∈rn f（x）≤α都是闭合的，则函数f:rn→r−∞，+∞是下半连续的。
观察实施例50.2的不适当凸函数不是下半连续的，因为当−∞<α<0时，次子Vα（f）=（−1,1）。这一结果反映了如下命题所示的铭文未闭合的事实；见Rockafella[134]（定理7.1）。
提案50.3.设f:rn→r−∞，+∞为任意函数。以下属性等效：
(1)	函数f是下半连续的。
(2)	F的铭文是RN+1中的一个闭集。
凸函数闭包的概念起着重要的作用。这有点微妙，因为凸函数可能不合适。
定义50.8.设f:rn→r−∞，+∞为任意函数。其上图是f（在rn+1中）的上图epi（f）的闭包的函数称为f的下半连续壳，如果f是凸函数，如果f（x）>−∞对于所有x∈rn，则f的闭包cl（f）等于其下半连续壳，否则如果f（x）=−∞对于某些x式中，f的闭式cl（f）是一个常数函数，其值为−∞。如果f=cl（f），则凸函数f是闭合的。
定义50.8意味着只有两个闭合的不适当凸函数：值为−∞的常数函数和值为+∞的常数函数。另外，根据50.3命题，一个适当的凸函数是闭的，当它等于它的下半连续壳时，当它的上图是非空的和闭的。
给定RN中的凸集c，c的内部int（c）（c中包含的RN的最大开子集）通常不有趣，因为c的维数可能小于n。例如，r3中的（闭合）三角形内部为空。
补救办法是考虑c的仿射hull aff（c），它是包含c的最小仿射集；见第43.2节。c的维数是aff（c）的维数。然后，c的相对内部是在aff（c）中c的内部，赋予aff（c）上的子空间拓扑。更明确地说，我们可以做出以下定义。
定义50.9.设c为rn的子集。C的相对内部是集合
换些衣服，
其中，圆心x和半径的开球。亲戚
C的边界定义为C−relint（C），其中C是RN中C的闭合（RN中包含C的最小闭合子集）。
备注：由riobserve设置c，int（（c）.c）relint（c）。Rockafella表示
Rockafella[134]的以下结果（定理7.2）告诉我们，不适当的凸函数通常取无穷大的值，除了在其有效域的相对边界点。
建议50.4.重新链接（dom（f））。因此，一个不适当的凸函数取无穷大的值，除了在相对论中，f是一个不适当的凸函数，那么f（x）=-∞对于每个x∈
有效域的边界点。
示例50.2说明了建议50.4。
以下结果也适用；见Rockafella[134]（推论7.2.3）。
建议50.5。如果f是一个有效域相对开放的凸函数，这意味着relint（dom（f））=dom（f），那么f（x）>−∞对于所有x∈rn，或f（x）=±∞对于所有x∈rn。
我们还得到了以下结果，表明适当凸函数的闭合与原始函数没有太大的区别；见Rockafella[134]（定理7.4）。
闭正凸函数，和命题50.6。设f:rn→rcl（f）+同意∞为适当的凸函数。除relativecl（f）外，dom（f）上的thenf是
边界点。
例50.3.关于命题50.6和50.5的一个例子的适当凸函数，设f:r→r+∞be
.
那么cl（f）是
clf（x）=（x2，如果x≤1
+∞如果x>1，
而clrelint x（f dom（x）=（f））=f（x）domwhen（f），f（xx）∈>（−∞∞，1）=allrelintx∈r（dom）。见图50.5.（f））=dom（f）。此外，因为
小奇迹：任何闭凸集的指示函数IC都是合适的闭凸集。
实际上，当α≥α0∈时，对于任意等于c的情况，andr子级setc是闭合的。x∈rn ic（x）≤α如果α<0，则为空的，或
我们现在简单地讨论凸函数的连续性。凸函数到其有效域的事实。还有一个问题，因为一个不适当的函数可能会起飞，使数值±∞变得困难，所以我们考虑了f值−∞的限制。然而，如果我们考虑任何子树（c）=c，那么c relint（domc of dom（（f）），因此，根据命题50.4，函数f）是相对开放的，这意味着

图50.5：实施例50.3的适当凸函数及其闭包。这两个函数只在dom（f）的相对边界点上有所不同，即x=1。
f在c上是常数−∞，因此可以认为它在c上是连续的，因此我们可以考虑适当的函数。
定义50.10。给出了一个适当的凸函数f，对于任意子集s dom（f），如果f对s的约束是连续的，那么f相对于s是连续的，并赋予s子空间拓扑。
以下结果在Rockafella[134]中得到证明（定理10.1）。
提案50.7。如果f是一个适当的凸函数，那么f在有效域dom（f）中包含的任何凸相对开放的子集c（relit（c）=c）上是连续的，特别是相对于relit（dom（f））。
作为推论，在rn上有限的凸函数f是连续的。
凸函数在有效域的相对边界点的行为可能很复杂。下面是Rockafella[134]的一个例子，说明了这些问题。例50.4。如果x>0 y，考虑由2/（2x）给出的适当凸函数（在r2上）
F（x，y）=0，如果x=0，y=0
+∞否则。
我们有
dom（f）=（x，y）∈r2 x>0（0,0）。
见图50.6。
函数f在右半平面上是连续的，而不是在（0,0）上。方程抛物线上（x，y）接近（0,0）时f（x，y）的极限

图50.6：实施例50.4的适当凸函数。当与x=α形式的垂直平面相交时，对于α>0，轨迹为向上抛物线。当α接近于零时，抛物线近似于正z轴。
x=y2/（2α）对于任何α>0为α。然而，如图50.7所示，很容易看出，从（0,0）到右半平面开口点的任何直线段的极限为0。
我们总结了凸函数的基本性质，并给出了涉及Lipschitz条件的结果。
定义50.11.设f:e→f为赋范向量空间e与f之间的函数，设u为e的非空子集，如果有c≥0，则称f Lipschitzian在u上（或在u上有Lipschitz条件），这样
kf（x）−f（y）kf≤ckx−yke对于所有x，y∈u。
显然，如果f在u上是Lipschitzian，它在u上是均匀连续的。下面的结果在Rockafella[134]中得到证明（定理10.4）。
提案50.8。设f为适当的凸函数，设为relit（dom（f））的任意（非空）闭有界子集。那么F是S上的李普希策。
特别地，RN上的有限凸函数是RN的每个紧子集上的李普希茨函数。然而，这样的一个函数可能不是李普希策关于RN的整体。

图50.7：图（a）说明了实施例50.4的适当凸函数。图（b）说明了沿平面抛物线（y2/2，y）接近（0,0）的方法。然后f（y2/2，y）=1，图b显示了表面与平面z=1的交点。
50.2次梯度和次微分
我们在前一节中看到，适当的凸函数具有“良好”的连续性。值得注意的是，如果f是一个凸函数，对于任何x∈rn，f（x）是有限的，那么所有u∈rn都存在单侧导数f0（x；u）；正如Stoltz所指出的，这个结果至少从1893年就已经显示出来了（见Rockafella[134]，第428页）。方向导数将在第50.3节中讨论。如果f在x处是可微分的，那么当然
dfx（u）=h fx，所有u∈rn的ui，
式中，f x是f在x处的梯度。
但即使f在x上是不可微的，结果表明对于“大多数”x∈dom（f），特别是对于x∈relit（dom（f）），存在一个非空闭凸集f（x），可以看作是梯度fx的推广。这个凸的Rn，f（x），称为f在x上的次微分，具有梯度fx的一些性质。f（x）中的向量称为x处的次梯度，例如，如果f是一个适当的凸函数，则f在x∈rn iff 0∈f（x）处达到其最小值。第49章的一些定理可以推广到凸函数，通过用包含次微分的条件替换包含梯度的条件，这些凸函数不一定是可微的。这些推广对于证明求解优化程序的各种迭代方法收敛是至关重要的。为了

举例来说，它们用于证明第章讨论的ADMM方法的收敛性。
51。
应该注意的是，次微分的概念不仅仅是一个无缘无故的数学泛化。优化问题
使j（u）最小化，服从u∈c，
式中，c是RN中的闭凸集，可重写为
最小化j（u）+ic（z），以u−z=0为准，
其中，ic是c的指示函数，强制我们处理不可微的函数，如j（u）+ic（z），即使j是。ADMM可以处理这种情况（在特定条件下），并且在证明其收敛性时，不能避免出现次微分。然而，应该说，次微分f（x）是一种理论工具，在实践中从未计算过（非常特殊的简单情况除外）。
要定义子梯度，我们需要检查（仿射）超平面。
回想一下，词缀形式：rn→r是形式的函数。
⑨（x）=h（x）+c，x∈rn，
式中h:rn→r为线性形式，c∈r为常数。仿射超平面h rn是任何非恒定仿射形式_：rn→r的核心（这意味着定义_的线性形式h不是零线性形式）。
h=_−1（0）=x∈rn（x）=0。
定义同一（仿射）超平面h的任意两个非恒定仿射形式，在h=_−1（0）=ψ−1（0）的意义上，必须成比例，这意味着存在一些非零α∈r，使得ψ=α_。
非常量仿射式_还定义了由下式给出的两个半空间h+和h−
h+=x∈rn _（x）≥0，h−=x∈rn（x）≤0。
显然，H+H−=H，它们的共同边界。见图50.8。符号的选择有点随意，因为α_的仿射形式α<0定义了h-和h+的半空间（半空间交换）。
由Rn上欧几里得内积诱导的对偶性，一个线性形式h:Rn→r对应一个唯一的向量u∈Rn，使得
h（x）=hx，所有x∈rn的ui。

图50.8：仿射超平面h=x∈r3 x+y+z−2=0。半空间H+面向观察者并包含点（0,0,10），而半空间H−位于H之后并包含点（0,0,0）。
inuThen if=06 h，和，和，和，xis，由u is给出的仿射形式，任意向量inis垂直于超平面，那么hx（−xh）=x0，在这个意义上，如果，uhix，u=0.i+c，这个仿射形式是非恒定的，iffx0∈h是任何固定向量。
实际上，h x 0，ui=x0hx，u∈hi，这意味着hx0 h，uxi−+xc0，u=0i=0.，x∈h意味着hx，ui+c=0，所以我们
下面是一个观察，它在定义次梯度概念中起着关键作用。图50.9给出了以下建议的说明。
提案50.9.设_：rn→r为非常量仿射形式。那么图ω：rn+1→
R给出者
ω（x，α）＝（x）−α，x∈rn，α∈r，
是定义超平面的非常数仿射形式，不能由非常数仿射形式（x，α）h7→=ψω（x−）1（0）定义，它不依赖于何为then+1的图，从αh.仿射形式_的意义上来说。此外，这个超平面在
证据。事实上，对于一些非零线性形式h，ω的形式是ω（x）=h（x）+c，因此
ω（x，α）=h（x）−α+c。
因为h是线性的，所以map（x，α）=h（x）−α明显是线性的且非零，soin rn+1。根据定义，ω是定义超平面h的非常数仿射形式。
h=（x，α）∈rn+1ω（x，α）=0=（x，α）∈rn+1（x）−α=0，
这是_的图形。如果h是一个垂直超平面，那么α，但是由h给出的仿射形式ω将由独立于且仿射形式ψ（x）不能成比例的ω（x，α）−α非常数仿射形式ψ定义，这是一个矛盾。

图50.9：设_：r→rα为仿射形式。超平面h_（x=）=ω−1X（0）+1.是带等式的红线，letω：r2→r是仿射形式ω（x，α）=x+1−x−α+1=0。
我们说，h是仿射式：rN→r诱导的超平面（在rn+1中）。还记得将超平面支持到凸集的概念。
定义50.12。如果c是rn中的非空凸集，x是c中的向量，那么仿射超平面h是x if上c的支持超平面。
(1)	X∈H。
(2)	C H+或C H-。
见图50.10。等价地，存在一些非恒定的仿射形式，例如，对于所有的z∈rn，对于一些非零的u∈rn和一些c∈r，那么，如果（z）=hz，ui-c，那么：
(1)	hx，ui=c。
(2)	hz，ui≤c，所有z∈c
垂直于圆锥体的向量的概念定义如下。
定义50.13。给定RN中的一个非空凸集c，对于任意a∈c，向量u∈rn在a if hz−a，ui≤0时对c是正态的，对于所有z∈c。
换言之，u不与以a为终点的c中的任何线段形成锐角。所有向量u的集合在a称为法锥到c，用nc（a）表示。见图50.11。
很容易确认a的法向C锥是凸锥。此外，如果仿射式定义的超平面h（z）=hz，则u 6=0的ui−c是c at的支持超平面。

图50.10：设c为r3中的实心桃四面体。绿色平面h是点x的支撑超平面，因为x∈h和c h+，即h只相交。c在含有x的边上，因此四面体位于
xm表示，由于hz，uui≤是所有zc∈atc xand的正常toc。这个概念如图50.12所示。hx，ui=c，我们有hz−x，ui≤0代表所有z∈c，其中
亚梯度的概念可以激发如下。a函数x∈rn if，f:rn→r不同-

对于所有的y∈rn，在一些包含）=0的非空子集中。此外，x，其中dfx:rn→r是一个线性形式，并且是一些函数，例如lim
dfx（y）=hy，fxi表示所有y∈rn，
式中，f x是f在x处的梯度，所以
.
如果我们假设f是凸的，用上式中的不等式符号≥替换等号，并将“误差项”f降到x if，那么向量u是
f（x+y）≥f（x）+hy，所有y∈rn的ui。
因此，我们得出以下定义。
定义50.14.设f:rn→ru−∞∈rn，使，+∞为凸函数。对于任意x∈rn，f在x处的次梯度是任意向量。
f（z）≥f（x）+hz−x，ui，对于所有z∈rn.（subgrad）
上述不等式称为次梯度不等式。f在x处所有子梯度的集合表示为f（x），称为。f在x处的次微分，如果f（x）=6∅，那么我们认为f在x处是可次微分的。

图50.11：设c为r3中的实心桃四面体。倒置的小洋红四面体是NC（A）的平移。图（a）显示了正圆锥与C之间由水平绿色支撑超平面分隔。图（b）表明，任何向量u∈nc（a）都不会与c中的直线段形成锐角。
假设f（x）是有限的。观察到次梯度不等式表明0是x的次梯度，iff f在x处有一个全局最小值。在这种情况下，超平面h（在rn+1中）
由仿射式定义的铭文epi（f）at（x，fω（（xx，α））。if）=u f∈（x）f−（xα）是一个水平支撑超平面to，u 6=0f（，thenx），如50.9命题中是a（subgrad），表示仿射形式向量（非垂直支撑超平面u，−1）诱导的超平面与超平面（inz r→h7 n+1z）垂直−与epigraphhx，u.见图50.13.i+epi（f）at（x，f（x））。这个
实际上，如果u 6=0，超平面h由
h=（y，α）∈rn+1ω（y，α）=0
当ω（y，α）=hy）−x，uepii（+f），byf（x）（−subgradα，so），我们得到ω（x，f（x））=0，这意味着（x，f（x））是∈h。
另外，对于任何（z，β
ω（z，β）=hz−x，ui+f（x）−β≤f（z）−β≤0，
从（n+1）到表意图，β∈epi（f），soepipie（f）（ATF）（hx，f（−x，and））。sinceh是一个非垂直支撑超平面
ω（y，α）=hy−x，u i+f（x）−α=h（y−x，α），（u−1）i+f（x），
向量（u、−1）确实垂直于超平面h。
因此，如果f（x）是有限的，那么f在x处是可分的，如果且仅当（x，f（x））上有一个非垂直支撑超平面（在rn+1中）时，f在x处是可分的。在这个里面

图50.12：设c为r3中的实心桃四面体。绿色平面h定义为（z）=hz，ui-c是a处c的支撑超平面。粉色垂直于h，即向量u，也垂直于a处c。
在这种情况下，有一个线性形式，由π（y）=hy−x，ui+（overf（x）rfor alln）给出，使得y∈rn.f（x）≥（x）代表所有x∈rn。我们可以挑选
很容易看出f（x）是闭的和凸的。集合f（x）可以为空，也可以简化为单个元素。在f（x）由单个元素组成的情况下，可以证明f在x附近是有限的，在x处是可微的，并且f（x）=fx，f在x处的梯度。
如50.5，可微分。X=06`2。对于范数xf=0（x）=，集合kxk2 fis对所有（0）可分的包含所有u rn，这样x rn，实际上
kzk2≥hz，所有z∈rn的Ui，
即（通过柯西-施瓦兹），欧几里得单位球u∈rn kuk2≤1。见图
50.14。
例50.6。f（0）是∞范数的多面体，如果f（x）=kxk∞，我们将其作为练习来证明
f（0）=conv±e1，…，±en。
见图50.15。如果x 6=0，也可以计算出f（x），但这更复杂；见Rockafella[134]，第215页。
例50.7。下面的函数是一个适当凸函数的例子，该函数在任何地方都不可细分：
.

图50.13：设f:r→r−∞，+∞1。其铭文是f（xr）=2定义的分段函数中的蓝色阴影区域。sincex+1华氏度
f的最小值为x=1，0∈f（1），图（1），褐红色线f（x）有一个水平支撑1+1（正态超平面在（1,1）。自从
1）和紫罗兰线1+1（正态（1））支持F（x）在（1,1）处的图形的超平面。
见图50.16。我们把它作为一个练习来证明，当x<1时，f在x处是可分的（事实上是可微的），但当x≥1时，f（x）=∅，即使x x=1时，x∈dom（f）。
例50.8。指标函数的次微分很有趣。设c为非空凸集。根据定义，u∈ic（x）iff
ic（z）≥ic（x）+hz−x，ui表示所有z∈rn。
由于x c∈是非空的，所以有一些c（否则，ic（x）=+∞zbut 0∈c，这样≥+∞c+athizxc。因此，−（z u，u）=0i，所以上述条件不可能），所以0∮ic（x）是法锥≥hz−x，ui对于所有z∈cc，这意味着在x.z是法向nc（x）到
例50.9。RN非负相关项的指示函数f的次微分揭示了与互补松弛条件的联系。回想一下，该指示器功能由
1≤i≤n，
.
例50.8中，f在x≥0处的次梯度y形成了x处的正锥面到非负的正锥面，这意味着y∈nc（x）iff
所有z≥0时，hz−x，yi≤0


图50.14：图（1）显示了（2）中的图，它显示了正态3为（f（x，y）=1）k的支持超平面，其中（x，y）k2（=px2+y2）。图形
敌我识别
hz，yi≤hx，yi表示所有z≥0。
特别是，对于z=0，我们得到hnx，yc（i≥x）iff0，对于hx，yi=0z and=2x≥0，我们得到hx，yi≤0，所以x，yi=0。因此，y∈
hz，yi≤0，所有z≥0。
hfor z=ej≥0，得z≥0，soyj≤0。相反，如果y≤0和hx，yi=0，因为x≥0，我们得到z，yi≤0。
f（x）=y=（y1，…，yn）∈rn y≤0，hx，yi=0。
但对于x≥y0∈和f（yx）≤iff，我们有0，因此我们看到
xj≥0，yj≤0，xjyj=0，1≤j≤n，
这是互补的松弛条件。
支持超平面到适当凸函数f的上图可以用来证明在优化理论中起关键作用的性质。证明采用了凸几何的经典结果，即支持超平面定理的闵可夫斯基。

图50.15：图（1）显示了f（x，y）=k（x，y）k∞=sup x，y的r3中的图形。图（2）显示了具有法向（1）的支撑超平面，其中（
定理50.10。（minkowski）设c为rn中的非空凸集。对于任何点a∈c−relit（c），在a处都有一个支持超平面h到c。
定理50.10在Rockafella[134]中得到证明（定理11.6）。另见Berger[11]（提案11.5.2）。证明并不像人们想象的那么简单，它是基于哈恩-巴纳赫定理的几何版本。
为了证明下面的定理50.13，我们需要两个技术命题。
提案50.11.设c为rn中的任何非空凸集。对于任何x∈relit（c）和

任何y∈c，我们都有（1−λ）x+λy∈relit（c），对于所有的λ，这样0≤λ<1。换句话说，从x到y的直线段（包括x和不包括y）完全位于换衬板（c）内。
命题50.11在Rockafella[134]中得到证明（定理6.1）。证明并不困难，但技术性很强。
提案50.12。对于RN上的任何适当凸函数f，我们有
relit（epi（f））=（x，礹）∈rn+1 x∈relit（dom（f）），f（x）<。
证据。提案50.12在Rockafella[134]中得到证明（Lemma 7.3）。通过在epi（f）的仿射壳中工作，命题50.12的陈述等价于
int（epi（f））=（x，礹）∈rm+1 x∈int（dom（f）），f（x）<，

图50.16：示例50.7中的函数图。
假设epi（f）的仿射壳的尺寸为m+1。见图50.17的图（1）。包含是显而易见的，所以我们只需要证明反向包含。然后对于任意z∈int（dom（f）），我们可以找到一个凸多面体子集p=conv（a1，…，am+1），其中a1，…，am+1∈dom（f），这样z∈int（p）。让
α=最大f（a1），…，f（am+1）。
因为任何x∈p都可以表示为
x=λ1a1+····+λm+1am+1，λ1+····+λm+1=1，λi≥0，
由于f是凸的，所以f（x）≤λ1f（a1）+·····+λm+1f（am+1）≤（λ1+·····+λm+1）α=α对于所有x∈p。
上面显示了开放子集
（x，礹）rm+1 x∈int（p），α<_
包含在EPI（f）中。见图50.17的图（2）。特别是，对于每一μ>α，我们有
（z，μ）∈int（epi（f））。
因此，对于β>f（z）的任何β∈r，我们可以看到（z，β）属于满足int（epi（f））的垂直线段（z，μ）的相对内部。见图50.17的图（3）。根据命题50.11，（z，β）∈int（epi（f））。
我们现在可以证明下列重要定理。
定理50.13。设f为rn上的一个适当凸函数。对于任何x∈relit（dom（f）），在（x，f（x））有一个非垂直支撑超平面h到epi（f）。因此，f对所有x∈relit（dom（f））都是次可区分的，并且有一些仿射形式，比如f（x）≥（x）对于所有x∈rn。

图50.17：图（1）说明了epi（f），其中epi（f）包含在仿射尺寸2的垂直平面中。图（2）说明了epi（f）的洋红色开底色（p），α<（x，）（z，_r）2 r x 2。图（3）说明了垂直线段{
f（z）≤μ≤α+β+1。
证据。根据命题50.13，对于任何x∈relit（dom（f）），我们对所有的∈r都有（x，μ）∈relit（epi（f）），这样f（x）<μ。由于根据epi（f）的定义，我们有（x，f（x））的∈epi（f）−relint（epi（f）），根据minkowski定理（定理50.10），存在一个支持超平面。
手的次梯度不等式表明，如果我们不是一个垂直超平面。根据定义50.14，函数epi（f）到（x，f（x））。由于x∈relit（dom_（（zf）=）和f（xf）+fis恰当，超平面在z−x，ui上是可分的，那么_是anx，
仿射形式，使得f（x）≥（x）对于所有x∈rn。
直观地说，一个适当的凸函数的下降速度不能快于仿射函数。令人惊讶的是，要证明这样一个“显而易见”的事实需要付出多少努力。
备注：考虑适当的凸函数f:r→r+∞，由
.
我们有dom（f）=[0，+∞），f对于所有x>0都是可微的，但在x=0时它不是可分的。如图50.18所示，方程x=0（y轴）的垂直线是（0.0）处epi（f）的唯一支撑超平面。
图50.18：f（x）=-√x处的部分函数超平面及其红色垂直支撑x=0的图。
50.3次梯度和次微分的基本性质
证明次梯度性质的主要工具是方向导数概念的变体。
定义50.15。设f:rn→r−∞u∈rn，+∞单边方向导数为任意函数。对于任何x∈f0r（xn；usuch），f（x）是有限的（f（x）∈r），对于任何定义为极限的

如果存在（−∞和+∞作为限制）。见图50.19。上述λ>0的符号趋向于0。极限意味着我们在
注意

表示当λ<0趋于零时的单边极限，以及
，

La＞0
x+λu
La＜0
图50.19：设f:r2→r−∞，+∞为其图（在r3中）是桃金字塔表面的函数。上图说明f0（x；u）是倾斜的烧焦橙色线的坡度，而下图则说明了与lim关联的线。
因此，（双面）方向导数duf（x）存在iff−f0（x；−u）=f0（x；u）。另外，如果f在x上是可微的，那么
f0（x；u）=h fx，ui，对于所有u∈rn，
式中，f x是f在x处的梯度。这里是第一个显著的结果。
提案50.14.设f:rn→r−∞，+∞为凸函数。对于任何x∈rn，
如果f（x）是有限的，那么函数

是λ>0的非衰减函数，因此f0（x；u）存在于任何u∈rn，并且
.
此外，f0（x；u）是u的正齐次凸函数（即f0（x；αu）=αf0（x；u），对于α>0且所有u∈rn的所有α∈r），f0（x；0）=0，并且
-f0（x；-u）≤f0（x；u）表示所有u∈rn
命题50.14在Rockafella[134]中得到证明（定理23.1）。证明并不困难，但资料不多。
注：作为u的凸函数，可以看出函数u 7→f0（x；u）的有效域是由dom（f）−x生成的凸锥。
现在，我们将在没有证据的情况下说明次梯度和次微分的一些最重要的性质。完整的细节可在Rockafella[134]中找到（第五部分，章节
23）。
为了陈述下一个命题，我们需要以下定义。
定义50.16。对于RN中的任何凸集c，c的支持函数δ（−c）定义为
δ（x c）=suphx，yi，x∈rn。
钇铝石榴石
根据定义49.11，凸集c的指示函数ic的共轭由下式给出：
.
因此，δ（−c）=ic，指示函数ic的共轭。
下面的命题涉及x的方向导数和x的次微分。
提案50.15。设f:rn→r−∞，+∞为凸函数。对于任何x∈rn，如果f（x）是有限的，那么向量u∈rn是x上f的次梯度，如果且仅当
f0（x；y）≥hy，ui表示所有y∈rn。
此外，凸函数y→7f0（x；y）的闭包是闭凸集f（x）的支持函数，f在x处的次微分：
cl（f0（x；−））=δ（−f（x））。
证明草图。命题50.15在Rockafella[134]中得到证明（定理23.2）。我们证明了不平等。如果我们在λ>0的情况下写出z=x+λy，则次梯度不等式意味着
，
所以我们得到
由于左边的表达式趋向于f0（x；y），因为λ>0趋向于零，我们得到了所需的不等式。第二部分来源于Rockafella的13.2.1推论[134]。
如果f是r上的一个适当函数，则其有效域为凸的区间，其相对内部为开区间（a，b）。在命题50.15中，我们可以选择y=1，所以hy，ui=u，对于任何x∈（a，b），因为存在极限；1）存在
，我们推断f（x）=[）]是
r2中通过（−x，f（x））的非垂直线的坡度，这些线是f的epi（f）的支撑线。
例50.10。如果f是来自深度学习的著名relu函数（斜坡函数），则定义为
零
ReLU
0，
然后relu（0）=[0,1]。见图50.20。函数relu对于x=06是可微的，如果x<0，relu0（x）=0，如果x>0，relu0（x）=1。

图50.20：relu函数的图形。
提案50.15有几个有趣的结果。
提案50.16。设f:rn→r−∞，+∞为凸函数。对于任意x∈rn，如果f（x）是有限的，如果f在x上是可分的，那么f是适当的。如果f在x处不可分，那么有一些y=06，这样
f0（x；y）=−f0（x；−y）=−∞。
命题50.16在Rockafella[134]中得到证明（定理23.3）。证明了不适当的凸函数是相当病态的对象，因为如果凸函数对某些x是可分的，那么f（x）是有限的，那么f必须是适当的。这是因为如果f（x）是有限的，那么次梯度不等式意味着f对仿射函数进行了优化，这是正确的。
下一个定理是关于单侧方向导数和次微分之间联系的最重要的结果之一。它使定理50.13的结果更加尖锐。
定理50.17。设f:rn→x∈rrelint+∞（dombe是一个适当的凸函数。对于任意（f）），我们有f（x）6=∅，映射x/y∈7→dom（f0（x；fy）），我们有f（x）=∅。因为任何是凸的、封闭的和适当的，并且
对于所有的y∈rn。
当且仅当x∈int（dom（f））时，次微分f（x）是非空有界的（也是闭的和凸的），在这种情况下，f0（x；y）对所有y∈rn都是有限的。
定理50.17在Rockafella[134]中得到证明（定理23.4）。如果我们写信
dom（f）=x∈rn f（x）6=，
那么定理50.17意味着
重新链接（dom（f））dom（f）dom（f）。
但是，dom（f）不一定是凸的，如下面的反例所示。例50.11。考虑在r2上定义的适当凸函数
F（x，y）=max g（x），y，
哪里
.
DOM（见图50.21。很容易看出dom（f）=（x，y）r2 x≥0−（0，y）−f1）=<y（<x，y1），这不是凸形的。∈r2 x≥0，但是
下面的定理很重要，因为它告诉我们凸函数的次微分何时是可微的，如Rockafellar[134]所示（定理25.1）。
定理50.18.如果f是可微的，那么f x是在en f（x）=fx（其中rn，且let fx是x rn的梯度，因此ffat（xx））是有限的。
有
f（z）≥f（x）+hz−x，fxi表示所有z∈rn。
相反，如果x.f（x）由单个矢量组成，那么f（x）=fx和f是可微的。
第一个方向很容易证明。实际上，如果f在x上是可微的，那么
f0（x；y）=hy，fxi表示所有y∈rn，
所以根据50.15，向量u是x iff的次梯度。
hy，fxi≥hy，ui表示所有y∈rn，
所以hy，fx−ui对于所有y都大于等于0，这意味着u=fx。
我们得到以下推论。

图50.21：示例50.11中的函数图，其视图沿着正x轴。
推论50.19。设f为rn上的凸函数，设x∈rn使f（x）是有限的。如果f在x上是可微的，那么f是恰当的，x∈int（dom（f））。
下面的定理表明，适当的凸函数几乎处处都是可微的。
定理50.20。设f为rn上的一个适当凸函数，设d为f可微的向量集。然后d是int（dom（f））的一个子集，其在int（dom（f））中的补码的度量值为零。此外，梯度图x 7→fx在d上是连续的。
定理50.20在Rockafella[134]中得到证明（定理25.5）。
注：如果f：（a，b）→r是r开区间上的有限凸函数，则f可微的集合d在（a，b）中稠密，（a，b）−d至多可数。图f0在d上是连续的且不递减的。见RockAfella[134]（定理25.3）。
我们还得到了以下结果，表明在“大多数情况”下，次微分f（x）可由梯度图构造；见Rockafella[134]（定理25.6）。
定理50.21。设f为RN上的闭正凸函数。如果int（dom（f））=6∅，那么对于每个x∈dom（f），我们有

f（x）=conv（s（x））+ndom（f）（x）
其中，ndom（f）（x）是x处的标准锥到dom（f），s（x）是f x1、f x2、f xp、…，其中x1、x2、…，xp，…，形式的所有序列极限的集合。是dom（f）中收敛到x的序列，以便定义每个fxp。
接下来的两个结果将关于导数的熟悉结果归纳为次微分。
提案50.22。设f1，…，fn为rn上的适当凸函数，设f=f1+·····+fn。
对于x∈rn，我们有
f（x）f1（x）+······fn（x）。ifrelint（dom（fi））=6∅，则
f（x）=f1（x）+·········fn（x）。
命题50.22在Rockafella[134]中得到证明（定理23.8）。
下一个结果可以看作是链规则的推广。
提案50.23。设f为f（x）=h（ax）给出的所有x∈rn的函数，其中h是rm上的一个适当凸函数，a是m×n矩阵。然后
f（x）a>（h（ax））表示所有x∈rn。
如果a的范围包含一个重新链接点（dom（h）），则
f（x）=a>（h（ax））。
命题50.23在Rockafella[134]中得到证明（定理23.9）。
50.4次微分的附加性质
一般来说，如果f:rn→r是一个函数（不一定是凸的），f在x处是可微的，我们期望f在x处的梯度fx与f（x）处的水平集z∈rn f（z）=f（x）垂直。类似的结果，如图50.22所示，适用于次微分的适当凸函数。
Proposition 50.24. Let f be a proper convex function on Rn, and let x ∈ Rn be a vector such that f is subdifferentiable at x but f does not achieve its minimum at x. Then the normal cone NC(x) at x to the sublevel set C = {z ∈ Rn | f(z) ≤ f(x)} is the closure of the convex cone spanned by ∂f(x).
Proposition 50.24 is proven in Rockafellar [134] (Theorem 23.7).
The following result sharpens Proposition 50.8.
Proposition 50.25. Let f be a closed proper convex function on Rn, and let S be a nonempty closed and bounded subset of int(dom(f)). Then

50.4. ADDITIONAL PROPERTIES OF SUBDIFFERENTIALS
 2
	sublevel set C	sublevel set C
Figure 50.22: Let f be the proper convex function whose graph in R3 is the peach polyhedral surface. The sublevel set C = {z ∈ R2 | f(z) ≤ f(x)} is the orange square which is closed on three sides. Then the normal cone NC(x) is the closure of the convex cone spanned by ∂f(x).
is nonempty, closed and bounded. If
 ,
then f is Lipschitizan on S, and we have
f0（x；z）≤αkzk2	对于所有x∈s和所有z∈rn
| F（Y）−F（X）≤αKY−ZK2	对于所有x，y∈s。
Proposition 50.23 is proven in Rockafellar [134] (Theorem 24.7).
The subdifferentials of a proper convex function f and its conjugate f∗ are closely related. First, we have the following proposition from Rockafellar [134] (Theorem 12.2).
Proposition 50.26. Let f be convex function on Rn. The conjugate function f∗ of f is a closed and convex function, proper iff f is proper. Furthermore, (cl(f))∗ = f∗, and f∗∗ = cl(f).
As a corollary of Proposition 50.26, it can be shown that
	f∗(y) =	sup	(hx,yi − f(x)).
x∈relint(dom(f))
The following result is proven in Rockafellar [134] (Theorem 23.5).

提案50.27。对于Rn上的任意适当凸函数f和任意向量x∈Rn，向量y∈Rn上的下列条件是等价的。

*(a)*            y f（x）。

*(b)*            函数hz，yi−f（z）在z=x时达到z的上确界。

*(c)*             F（x）+F（y）≤Hx，Yi。（d）f（x）+f（y）=hx，yi。

如果（cl（f））（x）=f（x），那么还有三个条件都与上述条件相等。

（a）x∈f（y）。

（b）函数hx，zi−f（z）在z=y时达到其上确界。

（a）y∈（cl（f））（x）。

以下结果是50.27号提案的推论；见Rockafella[134]（推论23.5.1、23.5.2、23.5.3）。

推论50.28。对于Rn上的任意适当凸函数f，如果f是闭的，则y∈∮f（x）iff x∈∮∮∮（y），对于所有x，y∈rn。

推论50.28表示一种附加性质。

推论50.29。对于Rn上的任何适当凸函数f，如果f在x∈Rn处是可分的，那么（cl（f））（x）=f（x）和（cl（f））（x）=f（x）。

推论50.29表明适当凸函数f的闭包与f一致，其中f是可分的。

推论50.30。对于RN上的任意适当凸函数f，对于RN的任意非空闭凸子集c，对于任意y∈RN，集δ（y c）=（y）由向量x∈RN（如果有的话）组成，其中线性形式z→h7z，yi在c上达到其最大值。

有一个近似次梯度的概念，在优化理论中是有用的；见Bertsekas[19，17]。

定义50.17。设f:rn→r+∞为任意适当的凸函数。对于任意>0，对于任意x∈rn，如果f（x）是有限的，那么f在x上的-次梯度是任意向量u∈rn，这样

，对于所有z∈rn。

见图50.23。f在x处的所有次梯度的集合表示）并称为f在x处的-次微分。

50.4。次微分的附加性质

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.gif)

图50.23：设f:r→r−∞，+∞为f（x）=x+1为1定义的分段函数。其铭文为R2中的蓝色阴影区域。线12（x−1）+1（有法向（12−1）是f（x）在（1,1）处的图的支持超平面，而线是与x=1处的-次梯度相关联的超平面，表明u=1∈f（x

集合）可以根据函数hx的共轭定义，由

hx（y）=f（x+y）−f（x），表示所有y∈rn。

提案50.31。设f:rn→r+∞为任意适当的凸函数。对于任何一个，如果hx由hx（y）=f（x+y）−f（x）给出，对于所有y∈rn，

那么对于所有的y∈rn

和

.

证据。我们有

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.gif)

观察）iff对于每个y∈rn，

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image005.gif)

敌我识别

.

因为根据定义

h x（u）=sup（h y，ui−hx（y）），y∈rn

我们得出结论

，

如要求。

注：根据Fenchel不等式0和命题50.27（d），消失的向量集是f（x）。

方程表明）是一个闭凸集。

随着变小，集合）减小，我们有

.

但是）不一定减少到δ（y f（x））=i f（x）（y）作为

减小到零。这种差异对应于f0（x；y）和δ（y f（x））=i f（x）（y）之间的差异，这是由于f不一定是封闭的（见命题50.15），如Rockafella[134]中证明的以下结果所示（定理23.6）。

提案50.32。设f是一个闭的、适当的凸函数，设x∈rn使f（x）是有限的。然后

对于所有的y∈rn。

凸函数理论很丰富，我们只给出了一些与优化理论有关的最重要结果的样本。关于凸函数的最小值，还有更多的结果，这些结果因其在优化理论中的应用而特别重要。

# 50.5适当凸函数的最小值

设h为rn上的一个适当凸函数。一般问题是研究RN中非空凸集C上H的最小值，可能由一组不等式和等式约束定义。我们已经观察到，最小化h超过c等于最小化由

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image007.gif)

因此，首先考虑Rn上的一个适当凸函数f的最小化问题是有意义的。当然，最小化超过rn等于最小化超过dom（f）。


 

定义50.18。设f为rn上的一个适当凸函数。我们用inf表示

inf f=inf f（x）。

x∈dom（f）

这是函数f对rn的最小值（它可能等于−∞）。对于每个α∈r，我们都有子级集

亚组vα（f）=x∈rn f（x）≤α。

通过命题50.2，我们知道子级集合subsevα（f）是凸的，并且

dom（f）=[亚单位α（f）。阿尔

观察亚组α（f）=∅如果α<inf f。如果inf f>−∞，那么对于α=inf f，亚组α（f）由一组向量组成，其中f达到最小值。

定义50.19。设f为rn上的一个适当凸函数。如果inf f>−∞，则子级集sublvinf f（f）称为f的最小集（此集可能为空）。见图50.24。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.gif)

图50.24：设f为适当的凸函数，其图形是向上的粉红色槽的表面。f的最小集合是r2的浅粉色正方形，它映射到r3中槽的底面。对于最小集合中的任何x，f0（x；y）≥0，由命题50.33证实的事实。

确定最小集是空的还是非空的，或者它是否包含一个点是很重要的。如定理39.11（2）中所述，如果f是严格凸的，那么最小集最多包含一个点。

在任何情况下，我们从命题50.2和50.3知道，f的最小集是凸的，闭的iff f是闭的。

次微分为确定向量x∈rn是否属于f的最小集提供了第一个准则，事实上，子梯度的定义表明x∈rn属于f iff 0∈f（x）的最小集。利用50.15号提案，我们得到以下结果。

提案50.33。设f是Rn上的一个适当凸函数。向量x∈rn属于f iff的最小集合。

0∈f（x）

iff f（x）是有限的，并且

f0（x；y）≥0表示所有y∈rn。

当然，如果f在x上是可微的，那么f（x）=fx，我们得到众所周知的条件fx=0。

有许多方法可以表达命题50.33的条件，f的最小集合甚至可以用共轭函数f来表示。经济衰退方向的概念起着关键作用。

定义50.20。设f:rn→r+∞为任意函数。f的后退方向是任意非零向量u∈rn，这样对于每一个x∈dom（f），函数λ7→f（x+λu）都是非递增的（这意味着对于所有的λ1，λ2∈r，如果λ1<λ2，那么x+λ1u∈dom（f），x+λ2u∈dom（f），和f（x+λ2u）≤f（x+λ1u））。

例50.12。考虑由f（x，y）=2x+y2给出的函数f:r2→r。因为f（x+λu，y+λv）=2（x+λu）+（y+λv）2=2x+y2+2（u+yv）λ+v2λ2，

当v=06时，我们发现λ≥−（u+yv）/v2的上述二次函数增加。如果v=0，则当λ变为+∞时，函数λ7→2x+y2+2uλ减小到−∞；如果u<0，则所有u>0的向量（−u，0）都是衰退方向。见图50.25。

函数f（x，y）=2x+x2+y2没有任何衰退方向，因为f（x+λu，y+λv）=2x+x2+y2+2（u+ux+yv）λ+（u2+v2）λ2，

由于（u，v）=（06，0），我们得到u2+v2>0，因此作为λ的函数，上述二次函数对于λ≥−（u+ux+yv）/（u2+v2）增大。见图50.25。

实际上，上面的例子是典型的。对于任意对称正定n×n矩阵a和任意向量b∈rn，由q（x）=x>ax+b>x给出的二次严格凸函数q没有后退方向。对于任何u∈rn，u=06，我们有

q（x+λu）=（x+λu）>a（x+λu）+b>（x+λu）

=x>ax+b>x+（2x>au+b>u）λ+（u>au）λ2.

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image011.gif)

图50.25：示例50.12中讨论的两个函数的图。f（x，y）=2x+y2的曲线沿负x轴“向下”倾斜，反映出（−u，0）是衰退的方向。

由于u=06，a为spd，则u>au>0，且上述二次函数随λ≥−（2x>au+b>u）/（2u>au）而增大。

上述事实给出了凸优化的一个重要技巧。如果f是一个适当的闭凸函数，那么对于任何二次严格凸函数q，函数h=f+q是一个适当的闭严格凸函数，对于一个唯一向量，它具有一个极小值。这个技巧是增强拉格朗日方法的核心，特别是ADMM。令人惊讶的是，严格的证明需要下面的深层定理。

应该注意不要草率地断定，如果凸函数是适当的且是闭的，那么dom（f）和im（f）也是闭的。另外，一个封闭的、适当的凸函数可能不能达到它的最小值。例如，函数f:r→r+∞由

+∞如果x≤0

是一个适当的闭函数和凸函数，但dom（f）=（0，+∞）和im（f）=（0，+∞）。请注意，未达到inf f=0。问题是f的1有一个衰退的方向，如图50.26所示。

以下定理在Rockafella[134]中得到证明（定理27.1）。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image013.gif)

图50.26:x>0的偏函数图。因为1是一个衰退的方向，所以这个函数的图沿着x轴递减。

定理50.34。设f为Rn上的一个适当闭凸函数。以下陈述成立：

*(1)*     我们有inf f=−f（0）。因此f在iff 0∈dom（f）下有界。

*(2)*     f的最小集合等于f（0）。因此，得到了f的中值（也就是说有一些x∈rn，这样f（x）=inf f）iff在0处是可分的。当0∈relint（dom（f））时，这种情况尤其适用。此外，当f的每一个衰退方向都是f不变的方向时，0∈relit（dom（f））。

*(3)*     对于f的中值是有限的，但不具绝对性，对于某些y∈rn，f（0）是有限的，（f）0（0；y）=-∞是必要和充分的。

*(4)*     f的最小集是一个非空有界集iff 0∈int（dom（f））。这种情况下，如果F没有衰退的方向。

*(5)*     f的最小集合由一个唯一的向量x组成，iff在x和

.

*(6)*     对于每一个α∈r，子类α（f）的支持函数是由f+α生成的正齐次凸函数的闭包。如果f在下面有界，则f的最小集合的支持函数是方向导数图y 7→（f）0（0；y）的闭包。

鉴于定理50.34（4）的重要性，我们将此性质表述为以下推论。

推论50.35。设f为RN上的闭正凸函数。那么F的最小集是一个非空有界集，如果F没有衰退的方向。特别地，如果f没有衰退方向，那么f的最小inf f是有限的，并且得到了一些x∈rn。

定理50.13包含以下结果，这对优化程序的设计非常重要。

提案50.36。设f为Rn上的一个适当闭凸函数。将q（x）=x>ax+b>x形式的任意严格凸二次函数q（其中a为对称正定）相加得到的h（x）=f（x）+q（x）所给出的函数h是一个适当的闭严格凸函数，使得inf f是有限的，并且有一个唯一的x∈rn，使得f达到其最小值以x（即f（x）=inf f）表示。

证据。根据定理50.13，有一些仿射形式，由π（x）=c>x+α（带α∈r）给出，这样f（x）≥（x）表示所有x∈rn。然后我们有了

h（x）=f（x）+q（x）≥x>ax+（b>+c>）x+α，所有x∈rn。

由于a是对称正定的，例如50.12，由q（x）=x>ax+（b>+c>）x+α给出的二次函数q没有衰退方向。由于h（x）≥q（x）对于所有x∈rn，我们认为h没有衰退的方向。否则，会有一些非零向量u，这样函数λ7→h（x+λu）对所有x∈dom（h）都是非递增的，所以h（x+λu）≤β对于某些β对于所有λ。但我们证明，对于足够大的λ，函数λ7→q（x+λu）的增加与λ2类似，因此对于足够大的λ，我们将得到q（x+λu）>β，这与H对q的优化相矛盾。根据推论50.35，h具有有限的最小x_。

如果f和g是适当的凸函数，如果g是严格凸函数，则f+g是适当的函数。对于所有x，y∈rn，对于任何λ，如果0<λ<1，因为f是凸的，g是严格凸的，我们有

F（（1-λ）x+λy）≤（1-λ）f（x）+λf（y）

g（（1-λ）x+λy）<（1-λ）g（x）+λg（y），

因此，我们推断f（（1-λ）x+λy）+g（（1-λ）x+λy）<（（1-λ）（f（x）+g（x））+λ（f（x）+g（x）））），

这表明f+g是严格凸的。然后，由于f+q是严格凸的，它在x处有一个唯一的最小值。

现在我们回到非空凸子集C上的一个适当凸函数h的最小化问题。这是一个很好的描述。

提案50.37。设h为rn上的一个适当凸函数，设c为rn的一个非空凸子集。

*(1)*     对于任何x∈rn，如果有一些y∈h（x），使得−y∈nc（x），即−y在x处对c是正态的，那么h在x处的c上达到其最小值。

*(2)*     如果换衬（dom（h））换衬（c）=6∅，则（1）的倒数保持不变。这意味着，如果h在x上达到c上的最小值，那么有一些y∈h（x），这样−y∈nc（x）。

命题50.37在Rockafella[134]中得到证明（定理27.4）。证明其实很简单。

证据。（1）根据50.33号提案，h在c上的x iff处达到其最小值。

0∈（H+IC）（X）。

根据提案50.22，自

（H+IC）（X）H（X）＋IC（X）、

如果0 h（x）+ic（x），则h在x处的c上达到其最小值。但我们在第50.2节中看到，ic（x）=nc（x），在x处的法锥到c。然后条件0 h（x）+ic（x）表示存在一些y h（x），使得某些z nc（x）的y+z=0，这相当于y∈nc（x）。

（2）根据IC的定义，条件relint（dom（h））relint（c）=6∅是50.22命题的假设

（H+IC）（X）=H（X）+IC（X）、

因此，我们推导出y∈（h+ic）（x），并通过50.33，h在c上达到其在x上的最小值。

注：多面体函数是其上图为多面体的凸函数。很容易看出，50.37（2）号提案也适用于以下情况

(1)    c为H多面体，换衬（dom（h））c=6∅

(2)    h为多面体，dom（h）relit（c）=6∅。

(3)    h和c都是多面体，dom（h）c=6∅。

# 50.6拉格朗日框架的推广

基本上，第49.3节、第49.7节、第49.8节和第49.9节中关于拉格朗日和拉格朗日对偶的所有结果都推广到包含适当和凸目标函数j、适当和凸不等式约束和仿射等式约束的程序。额外的普遍性是不再假定这些函数是


 

50.6。拉格朗日框架的推广

可微的。这一理论在Rockafella[134]第六部分第28节中对称为普通凸形程序的程序进行了详细讨论。我们没有足够的空间来勾画这个理论，但我们会详细说明一些关键的结果。

我们将处理由一个凸而恰当的目标函数j:rn→r+∞组成的程序，受m≥0不等式约束，其中，i（v）≤0，p≥0仿射等式约束，ψj（v）=0。约束函数i也是凸的和适当的，我们假设relint（dom（j））relint（dom（i））、dom（j）dom（i），i=1，…，m。

这种程序称为普通凸程序。让

u=dom（j）v∈rn i（v）≤0，ψj（v）=0，1≤i≤m，1≤j≤p，

做一套可行的解决方案。我们正在寻找u∈u中使j在u上最小化的元素。

定理49.17的一个广义版本在上述关于j的假设和约束条件i和ψj下成立，但在kkt条件下，涉及梯度的方程必须替换为涉及次微分的下列条件：

，

当i=1，…，m时，λi≥0，j=1，…，p时，m和μj∈r（其中u∈u和j在u处达到其最小值）。

我们问题的拉格朗日L（v，λ，ν）定义如下：

EM＝{X* RM+P Xi±0, 1±i±m }。

然后

DOM（j）

γ

L（V，λ，礹）=-∞如果（λ，礹）∈/em，V∈dom（j）

+∞如果v/∈dom（j）。

对于固定值，我们还定义了由

，

其有效域为dom（j）（因为我们假设dom（j）dom（i），i=1，…，m）。因此，h（x）=l（x，λ，μ），但h仅是x的函数，因此我们用不同的方式表示它以避免混淆（从技术上讲，l（x，λ，μ）可以取值−∞，但h不取）。

因为j和_i是适当的凸函数，而ψj是仿射函数，所以函数h是适当的凸函数。

通过将定理28.1、定理28.2和定理28.3放在Rockafella[134]中，可以得到定理49.17的广义版本的证明。为了完整性，我们陈述了这些定理。这是定理28.1。

定理50.38。（定理28.1，Rockafella）让（p）是一个普通的凸规划。设为拉格朗日乘子，使得函数h=j+的中值是有限的，等于j在u上的最佳值。设d为

Rn上h的极小集，设i=i∈1，…，mλi=0。如果d0是d的子集

由向量x组成，使得

| _i（x）≤0          | 就我而言                        |
| ------------------ | ------------------------------- |
| ⑨i（x）=0ψj（x）=0 | 对于所有i/∈i对于所有j=1，…，p， |

那么，d0是u上（p）的极小值集。

这里是定理28.2。

定理50.39。（定理28.2，Rockafella）让（p）是一个普通的凸规划，让i 1，…，m是非仿射不等式约束的指数的子集。假设（p）的最优值是有限的，并且（p）至少有一个可行解x∈relint（dom（j）），这样

_i（x）<0表示所有i∈i。

然后存在一些拉格朗日乘数（不一定是唯一的），这样

（a）函数的中值是有限的，等于j在u上的最优值。

定理50.39的假设是约束条件的限定条件，本质上是来自定义49.6的斯莱特条件。

定义50.21。设（p）为普通凸规划，设i 1，…，m为非仿射不等式约束的指数的子集。约束是限定的，是否存在一个可行的解x∈relint（dom（j）），使得

_i（x）<0表示所有i∈i。

最后，这里是Rockafella[134]的定理28.3。

定理50.40。（定理28.3，Rockafella）让（p）是一个普通的凸规划。如果x∈rn，那么（λ，μ）和x具有

50.6。拉格朗日框架的推广

*(a)*     函数的中值是有限的，等于j在u上的最优值，并且

*(b)*     向量x是（p）（so x∈u）的最优解，iff（x，λ，μ）是（p）的拉格朗日L（x，λ，μ）的鞍点。

此外，如果以下KKT条件成立，则该条件成立：

，且当i=1，…，m时，λi_i（x）=0。

（2）对于j=1，…p，ψj（x）=0。

.

注意，根据定理50.39，如果（p）的最佳值是有限的，并且约束是合格的，则定理50.40的条件（a）适用于（λ，μ）。因此，我们得到了库恩和塔克定理50.40的以下推论，这是该理论的主要结果之一。它是定理49.17的一个推广版本。

定理50.41。（定理28.3.1，rockafellar）让（p）是一个满足定理50.39假设的普通凸规划，这意味着（p）的最优值是有限的，并且约束是合格的。为了使向量x∈rn是（p）的最优解，存在拉格朗日乘子（λ，祄）是（x，λ，祄）是L（x，λ，祄）的鞍点，这是必要和充分的。等价地，如果且仅当存在拉格朗日乘子时，x是（p）的最优解，它与x一起满足定理50.40中的KKT条件。

定理50.41与（p）的最优解的存在性有关，但它没有说明（p）的最优值。为了建立这样一个结果，我们需要对偶函数的概念。

双功能G的定义如下：

g（λ，μ）=inf l（v，λ，μ）。Ⅴrn

它是一个凹函数（所以−g是凸函数），可以取±∞。请注意，最大化g（相当于最小化−g）会遇到问题，如果对于某些λ，礹，g（λ，礹）=+∞但g（λ，礹）=-∞不会导致问题。乍一看，这似乎违反直觉，但请记住，G是凹的，而不是凸的。凸的是−g，并且−∞和+∞被翻转。

然后，定理49.18（2）的一个更广、更强的版本也成立。通过将推论28.3.1、定理28.4和推论28.4.1放在Rockafella[134]中，可以得到一个证明。为了完整起见，我们陈述了Rockafella[134]的以下结果。

定理50.42。（定理28.4，Rockafella）让（p）是一个具有拉格朗日l（x，λ，μ）的普通凸规划。如果拉格朗日乘子和向量x∈rn具有

*(a)*    函数的中值是有限的，等于j在u上的最优值，并且

*(b)*    向量x是（p）（so x∈u）的最优解，

则鞍值L（x，λ，）为（p）的最佳值J（x）。

一般来说，拉格朗日乘数具有（a）iff的性质。

−∞<inf l（x，λ，）≤suinf l（x，λ，）=inf supl（x，λ，）

xλ，礹xλ，礹

在这种情况下，极值的公共值是（p）的最佳值。特别是，如果x是（p）的最优解，那么supλ，μg（λ，μ）=l（x，λ，μ）=j（x）（零对偶间隙）。

注意定理50.42给出了对偶间隙为零的充分条件（a）和（b）。根据定理50.40，这些条件等价于（x，λ，）是l的鞍点，或等价于KKT条件所具有的事实。

同样，根据定理50.39，如果（p）的最佳值是有限的，并且约束是合格的，则定理50.42的条件（a）适用于（λ，μ）。定理50.42的以下推论成立。

定理50.43。（定理28.4.1，rockafellar）让（p）是一个满足定理50.39假设的普通凸规划，这意味着（p）的最优值是有限的，并且约束是合格的。拉格朗日乘子具有函数中值为有限且等于j在u上的最优值的性质，正是G得到的对偶函数是r的上确界的向量。

定理50.43是定理49.18（2）的一个广义的、更强的版本。定理49.18的第（1）部分要求j和_i是可微的，因此它不概括。

关于普通凸规划和另一类广义凸规划，可以给出更多的结果。然而，我们并不需要这样的结果来达到我们的目的，特别是讨论ADMM方法。感兴趣的读者可参考Rockafella[134]（第六部分第28和29节）。

# 50.7总结

本章的主要概念和结果如下：

•     扩展实值函数。

50.7。总结

•     铭文（epi（f））。

•     凸凹（扩展实值）函数。

•     有效域（dom（f））。

•     适当和不适当的凸函数。

•     子级集合。

•     下半连续函数。

•     下半连续船体；凸函数的闭合。

•     相对内部（换衬（c））。

•     指示器功能。

•     利普希茨条件。

•     仿射形式，仿射超平面。

•     半个空格。

•     支持超平面。

•     A处的法向圆锥。

•     次梯度，次梯度不等式，次微分。

•     闵可夫斯基支持超平面定理。

•     单侧方向导数。

•     支持功能。

•     Relu功能。

•     -次梯度。

•     凸函数的最小集。

•     衰退的方向。

•     普通凸规划。

•     一套可行的解决方案。

•     拉格朗日

•     鞍点。

•     KKT条件。

•     限定约束。

•     二元性差距。


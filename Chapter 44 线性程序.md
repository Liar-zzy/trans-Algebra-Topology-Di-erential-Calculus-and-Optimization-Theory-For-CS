第四十四章
线性程序
44.1线性规划、可行解、最优解
线性规划的目的是解决以下类型的优化问题。
定义44.1.线性规划（P）是一类优化问题：
最大化cx，以a1x≤b1为准
…
amx≤bm x≥0，
其中x∈rn，c，a1，…，am∈（rn），b1，…，bm∈r。
线性形式c定义了线性规划（p）的目标函数x 7→cx（从rn到r），其中的不等式aix≤bi和xj≥0称为线性规划（p）的约束条件。
如果我们定义m×n矩阵，其行是行向量a1，…，am和b作为列向量
b1
B=……，BM
一千四百二十三
m不等式约束aix≤bi可以写成矩阵形式
ax≤b。
因此，线性程序（P）也可以表示为线性程序（P）：
最大化cx，以ax≤b和x≥0为准。
下面是（p）类型线性程序的显式示例：
例44.1。
最大化x1+x2取决于
x2−x1≤1 x1+6x2≤15 4x1−x2≤10 x1≥0，x2≥0，
以矩阵形式
最大化受试者

结果表明，x1=3，x2=2产生目标函数x1+x2的最大值，即5。如图44.1所示。注意，满足上述约束条件的点集是由方程线确定的半平面切出的凸区域。
x2−x1=1
x1+6x2=15
4x1−x2=10 x1=0 x2=0。

44.1。线性规划、可行解、最优解

图44.1：与实施例44.1相关的H多面体。绿点（3，2）是唯一的最优解。
一般来说，每个约束Ax≤Bi对应于由i（x）=Ax−Bi给出的仿射形式i，并定义半空间h−（i），每个不等式xj≥0定义半空间h+（xj）。这些半空间的交集是所有这些约束的解集。它是一个（可能是空的）H多面体，表示P（A，B）。
定义44.2.如果p（a，b）=∅，我们说线性规划（p）没有可行解，否则任何x∈p（a，b）都称为（p）的可行解。
示例44.2中所示的线性程序，通过逆转示例44.1中线性程序中的不等式x2−x1≤1和4x1−x2≤10的方向获得，没有可行的解；见图44.2。
例44.2。
最大化x1+x2取决于
x1−x2≤−1 x1+6x2≤15 x2−4x1≤−10 x1≥0，x2≥0。
假设P（A，B）6为∅，使线性规划（P）有一个可行解。在这种情况下，考虑目标函数x 7→cx下p（a，b）的图像cx∈r x∈p（a，b）。
定义44.3.如果集合cx∈r x∈p（a，b）在上面是无界的，那么我们就说线性程序（p）是无界的。

图44.2：由于蓝色和紫色区域不重叠，因此没有与实施例44.2相关的H多面体。
示例44.3中所示的线性程序是从示例的线性程序中获得的。
44.1通过删除限制条件4x1−x2≤10和x1+6x2≤15，无边界。
例44.3。
最大化x1+x2取决于
.
x∈potherwise，我们将很快证明，如果（a，b），那么有一些p∈p（a，b），那么这是集合cx∈r的最小上界。|
Cp=μ，
也就是说，某个p∈p（a，b）.x→7cx的目标函数在p（a，b）上有一个最大值μ，达到了
定义44.4。（或最优，如果集合cx=∈maxr xcx∈p∈r（a，b x）∈p是非空且在上面有界的，则任何（a，b）称为；例如，最优解p。点p∈p（）a，bof）（psuch that）。最优解通常用上cp_表示。
例44.1的线性规划有一个唯一的最优解（3,2），但观察到例44.4中目标函数为（1/6）x1+x2的线性规划有无穷多的最优解；目标函数的最大值为15/6，出现在橙色bo的点上。图44.1中的日期线。
44.1。线性规划、可行解、最优解
例44.4。
最大化受试者
x2−x1≤1 x1+6x2≤15 4x1−x2≤10 x1≥0，x2≥0。
证明如果集合cx∈r x∈p（a，b）是非空的且在上面有界的，那么有一个最优解p∈p（a，b），并不像它看起来那样简单。这取决于多面体圆锥是闭合的这一事实，如第43.3节所示。
我们还使用了一个使证明更简单的技巧，即具有不等式约束ax≤b的线性程序（p）
最大化cx，以ax≤b和x≥0为准，
等价于具有相等约束的线性程序（p2）
最大化C x BB
服从且x≥0，
乙
其中ab是m×（n+m）矩阵，bc是（rn+m）中的线性形式，xb∈rn+m，由
，和，
用x∈rn和z∈rm表示。
确实，0 iff
网络错误
网络错误	网络错误
网络错误	网络错误
C x=cx。BB
变量z称为松弛变量，形式（p2）的线性程序称为标准形式的线性程序。
将示例44.4的线性程序转换为标准格式的结果是示例44.5所示的程序。
例44.5。
最大化受试者
x2−x1+z1=1 x1+6x2+z2=15 4x1−x2+z3=10 x1≥0，x2≥0，z1≥0，z2≥0，z3≥0。
我们现在可以证明，如果一个线性规划有一个可行解并且有界，那么它就有一个最优解。
提案44.1.设（p2）为标准形式的线性规划，等式约束a x=b，如果p（a，b）是非空的，且在其上有界，如果μ是集合cx∈r x∈p（a，b）的最小上界，则有一些p∈p（a，b），这样
Cp=μ，
也就是说，目标函数x 7→cx在p（a，b）上有一个最大值μ，这是由一些最优解p∈p（a，b）实现的。
证据。由于μ=sup cx∈r x∈p（a，b），有一个向量的序列（x（k））k≥0
x（k）∈p（a，b），使limk7→∞cx（k）=µ。尤其是，如果我们写
我们有并且对于所有的k≥0。设ae为（m+1）×n矩阵
，
并考虑向量axe（k）的序列（axe（k））k≥0∈rm+1。我们有
，
由于假设x（k）∈p（a，b），约束条件为ax=b，x≥0。由于假设limk7→∞cx（k）=µ，序列（axe（k））k≥0收敛于矢量。现在，观察每个矢量轴（k）可以写成凸组合
，
其中，aej∈rm+1为ae的jth列。因此，axe（k）属于多先驱锥
C=锥形（，

由于这个锥是封闭的，所以limk≥∞axe（k）∈c，这意味着存在一些u∈rn，其中u≥0，这样
，
也就是说，cu=μ，au=b。因此，u是（p2）的最佳溶液。
下一个问题是，我们如何找到这样一个最优解？结果表明，对于标准形式的线性规划，约束形式为a x=b和x≥0时，总是存在一种特殊类型的最优解，称为基本可行解。
44.2基本可行解和顶点
如果系统ax=b有一个解，如果a的某一行是其他行的线性组合，那么相应的方程是多余的，因此我们可以假设a的行是线性无关的；也就是说，我们可以假设a的列是m，因此m≤n。
如果a是m×n矩阵，对于1，…，n的任何非空子集k，让ak是a的子矩阵，a的列的索引属于k。我们用aj表示矩阵a的jth列。
定义44.5.给定线性程序（p2）
最大化cx，以ax=b且x≥0为准，
在a有秩m的情况下，向量x∈rn是（p）的基本可行解，如果x∈p（a，b）=6∅，并且如果存在尺寸m的1，…，n的某个子集k，则
(1)	矩阵AK是可逆的（也就是说，AK的列是线性无关的）。
(2)	xj=0表示所有j/∈k。
子集k称为x的基，每一个索引k∈k称为基，每一个索引j/∈k称为非基。同样，对应于指数k∈k的列ak称为基本列，对应于指数j/∈k的列aj称为非基本列。与基本指标k∈k对应的变量称为基本变量，与指标j/∈k对应的变量称为非基本变量。
例如，线性程序
最大化x1+x2
x1+x2+x3=1且x1≥0，x2≥0，x3≥0，（）
有三个基本可行解：基本可行解K=1对应点（1,0,0）；基本可行解K=2对应点（0,1,0）；基本可行解K=3对应点（0,0,1）。每个点对应图44.3所示的倾斜紫色三角形的顶点。顶点（1，0，0）和（0，1，0）以1的值优化目标函数。

图44.3：与线性程序（）相关的H-多面体。目标函数（x1→x和x2→y）由平行于紫色平面x+y=0.7的垂直平面表示，当x+y=1时达到最大值。
我们现在证明，如果定义44.5中的标准线性规划（p2）有一些可行解，并且在上面有界，那么一些基本可行解就是一个最优解。我们遵循马托塞克和加德纳[120]（第4章，第2节，定理4.2.3）。
首先，我们得到了一个更方便的基本可行解的表征。
提案44.2.给定任意标准线性规划（p2），其中a x=b，a是秩m的m×n矩阵，对于任意可行解x，如果j>=j∈1，…，n xj>0，那么x是一个基本可行解，如果矩阵aj>的列是线性无关的。
证据。如果x是一个基本可行解，那么M的子集k 1，…，n使得ak的列是线性无关的，并且x j=0表示所有j/∈k，因此根据定义，j>k，这意味着矩阵aj>的列是线性无关的。
相反，假设x是一个可行的解，使得矩阵aj>的列是线性无关的。如果j>=m，我们就完成了，因为我们可以选择k=j>，那么x是一个基本可行的解决方案。如果j>m，我们可以通过添加m−j>列索引将j>扩展到m元素子集k，以便ak的列是线性独立的，这是可能的，因为a具有秩m。
其次，我们证明了如果一个标准形式的线性规划有任何可行解X0，并且在其上有界，那么它就有一些基本可行解Xe，在cxe≥cx0的意义上，它和X0一样好。
提案44.3.设（p2）为目标函数为cx的任意标准线性规划，其中ax=b，a是m×n阶矩阵，如果（p2）在上有界，如果（p2）是（p2）的某个可行解，则存在一些基本可行解xe，使cxe≥cx0。
证据。在可行的解x中，cx≥cx0（其中x0是其中之一）选择一个最大坐标数xj等于0的解，比如xe。让
k=j>=j∈1，…，n xej>0
让我们=k。我们认为XE是一个基本可行的解决方案，通过构造cXe≥cX0。
如果ak的列是线性无关的，那么根据44.2，我们知道Xe是一个基本可行的解，我们就这样做了。
否则，ak的列是线性相关的，所以有一些非零向量v=（v1，…，vs），这样ak v=0。设w∈rn为所有j/∈k通过设置wj=0扩展v得到的向量，通过构造，
aw=ak v=0.
我们将通过展示一个可行的解决方案x（t0）得出一个矛盾，这样cx（t0）≥cx0的零坐标比x多。
e
为此，我们声称我们可以假设w满足以下两个条件：
(1)	cw≥0.
(2)	有一些j∈k使得wj<0。
如果cw=0，如果条件（2）失败，自w=06以来，对于一些j∈k，我们有wj>0，在这种情况下，我们可以使用−w，其中wj<0。
如果c w<0，则c（−w）>0，因此我们可以假设cw>0。如果wj>0表示所有j∈k，因为x是可行的，x≥0，所以x（t）=x+tw≥0表示所有t≥0。此外，由于aw=0和e e e x是可行的，我们有e
ax（t）=ax+taw=b，e
因此x（t）对所有t≥0都是可行的。我们也有
cx（t）=cx+tcw。
e
由于cw>0，当t>0变为无穷大时，目标函数cx（t）也趋于无穷大，这与上面有界的事实相矛盾。因此，必须存在满足上述（1）和（2）条件的一些w。
结果表明，存在一些t0>0，使得cx（t0）≥cx0和x（t0）=xe+t0w是可行的，但x（t0）的零坐标比xe多，这是一个矛盾。
因为x（t）=x+tw，我们有
e x（t）i=xei+twi，
因此，如果我们让i=i∈1，…，n wi<0 k，这是非空的，因为w满足上述条件（2），如果我们选择
，
然后t0>0，因为wi<0代表所有i∈i，根据k的定义，我们得到xei>0代表所有i∈k。根据t0>0的定义，由于xe≥0，我们得到
x（t0）j=xej+t0wj≥0，对于所有j∈k，
因此x（t0）≥0，x（t0）i=0，对于某些i∈i，因为ax（t0）=b（对于任何t），x（t0）是一个可行的解，cx（t0）=cxe+t0cw≥cx0+t0cw≥cx0，
而x（t0）i=0，对于一些i∈i，我们看到x（t0）的零坐标比xe多，这是一个矛盾。
44.3号提案意味着以下重要结果。
定理44.4。设（p2）为目标函数为cx的任意标准线性规划，其中ax=b，a是m×n阶矩阵，如果（p2）有一些可行解，如果（p2）有上界，那么一些基本可行解Xe是（p2）的最优解。证据。根据命题44.3，对于任何可行解x，都有一些基本可行解x
使cxcx。但是只有有限多的基本可行解，所以其中之一
e必须得到目标函数的最大值。
几何学上，基本解就是多面体p（a，b）的顶点，我们现在定义了这个概念。
定义44.6.给定一个H多面体p rn，p的一个顶点是一个点v∈p，其性质是存在一些非零线性形式c∈（rn）和一些r，因此v是p的唯一点，其中，map x 7→cx具有最大值μ；即，对于所有y∈p−v，cy<cv=μ。几何上，这意味着方程cy=μ的超平面恰好在v处与p接触。更一般地说，p的凸子集f是p的k维面，如果f有维数k，并且如果存在某种仿射形式，那么，对于所有y∈f，cy=μ，对于所有y∈p−f，cy<μ。一维面称为边。
顶点的概念如图44.4所示，而边缘的概念如图44.5所示。
由于k维p的面f等于方程cx=祄的超平面h（）与p的交点，因此它确实是凸的，并且尺寸的概念是有意义的。

图44.4：以原点为中心、对角线穿过（−1、−1、−1）和（1,1,1）的立方体有八个顶点。顶点（1,1,1）与线性形式x+y+z=3相关。
观察P的0维面是一个顶点。如果p有维d，则p的（d-1）维面称为其面。
如果（p）是标准形式的线性规划，那么它的基本可行解就是多面体p（a，b）的顶点。为了证明这一事实，我们需要以下简单的命题
提案44.5。设a x=b是一个线性系统，其中a是秩m的m×n矩阵。对于任意子集k 1，…，n的大小m，如果ak是可逆的，那么对于所有j/∈k（当然，x≥0），至多有一个基本可行解x∈rn，其中xj=0。
证据。为了使x可行，我们必须有ax=b。写n=1，…
ax=akxk+anxn=b。
为了使x是一个基本可行的解，我们必须有xn=0，所以
AKXK=B。
由于假设ak是可逆的，所以xk=a−k1b是唯一确定的。如果xk≥0，那么x是一个基本可行解，否则它不是。证明了对于所有的j/∈k，至多有一个基本可行解x∈rn，xj=0。
定理44.6。设（p）为标准形式的线性规划，其中ax=b，a为秩m的m×n矩阵，对于每个v∈p（a，b），下列条件是等价的：

图44.5：立方体中心位于原点，对角线穿过（−1、−1、−1）和（1,1,1）有十二条边。从（1,1、−1）到（1,1,1）的边与线性形式x+y=2相关。
(1)	v是多面体p（a，b）的顶点。
(2)	v是线性规划（p）的基本可行解。
证据。首先，假设v是p（a，b）的顶点，并让_（x）=cx−µ是一个线性形式，这样所有y∈p（a，b）和cv=µ的cy<µ。这意味着v是p（a，b）的唯一点，目标函数x 7→cx在p（a，b）上具有最大值μ，因此根据定理44.4，由于这个最大值是由一些基本可行解获得的，所以唯一性v必须是基本可行解。
相反地，假设v是（p）的一个基本可行解，对应于大小m的子集k 1，…，n。让bc∈（rn）是由

通过构造Cv=0且Cx≤0，因此p（a，b）b b b上的函数x→7cx在v处有最大值。此外，对于任何x≥0，Bcx<0，使得x j>0对于某些j/∈k。然而，根据44.5，向量v是唯一基本可行的解，使得vj=0对于所有j/yk，因此v是p（a，b）最大化函数x 7→cx的唯一点，
所以它是一个顶点。
在理论上，为了找到一个最优解，我们尝试了所有可能的m元素子集k，1，…，n，并求出相应的akx=b的唯一解xk，然后检查该解是否满足xk≥0，计算cxk，并返回一个目标函数最大的可行xk。这是一个完全不切实际的算法。
一种实用的算法是单纯形算法。基本上，simplex算法试图在polyhdron p（a，b）中沿着边缘从顶点到顶点“爬升”（使用基本可行解），试图最大化目标函数。我们将在下一章中介绍单纯形算法。读者也可以查阅有关线性规划的文本。特别是，我们推荐马托塞克和加德纳[120]、奇瓦塔尔[40]、帕帕迪米特里奥和斯蒂格里茨[130]、伯特西马斯和齐齐克利斯[21]、西亚莱[41]、施里伊弗[144]和范德贝[175]。
注意，定理44.4断言，如果标准形式的线性规划（p）（其中ax=b和a是m×n阶矩阵）有一些可行解，并且在其上有界，那么一些基本可行解就是最优解。根据定理44.6，多面体p（a，b）必须有一些顶点。
但是假设我们只知道p（a，b）是非空的，也就是说，我们不知道目标函数cx在上面是有界的。p（a，b）有顶点吗？
上述问题的答案是肯定的，这一点很重要，因为单纯形算法需要一个初始的基本可行解才能开始。这里我们证明，如果p（a，b）是非空的，那么它必须包含一个顶点。这个证明仍然没有构造性地生成一个顶点，但是我们将在下一章看到，如果有一个顶点，simplex算法总是找到一个顶点（前提是我们使用一个防止循环的轴规则）。
定理44.7。设（p）为标准形式的线性规划，其中ax=b，a是秩m的m×n矩阵，如果p（a，b）是非空的（有可行解），则p（a，b）有一些顶点；等价地，（p）有一些基本可行解。
证据。证明依赖于一个技巧，即添加松弛变量xn+1，…，xn+m并使用新的目标函数−（xn+1+····+xn+m）。
如果我们让ab是m×（m+n）-矩阵，x、x和xb是由
，
然后考虑标准形式的线性程序（P）
最大化−（xn+1+····+xn+m），以abxb=b和xb≥0为准。
由于所有I的Xi超0，目标函数（xn+1＋···+xn+m）有界以上0。系统abxb=b相当于系统
ax+x=b，
因此，对于每一个可行解u∈p（a，b），由于au=b，向量（u，0m）也是（pb）的可行解，实际上是一个最优解，因为x=0的目标函数−（xn+1+·····+xn+m）的值为0。根据命题44.3，线性规划（pb）有一些基本可行解（u，w），其中目标函数的值大于或等于（u，0 m）的目标函数的值，并且由于（u，0 m）是最优解，（u，w）也是（pb）的最优解。）这意味着w=0，因为否则目标函数−（xn+1+·····+xn+m）将具有严格的负值。
因此，（）是（pb）的基本可行解，因此u的非零分量对应的列是线性无关的。u的一些坐标可以等于0，但由于a具有秩m，我们可以添加a的列以获得与u相关的基k，并且u确实是（p）的基本可行解。
基本可行解的定义可适用于约束形式为a x≤b，x≥0的线性程序；见Matousek和Gardner[120]（第4章，
第4节，定义4.4.2）。
除了形式aix≤bi的约束之外，最常见的线性程序类型还允许形式aix≥bi或aix=bi的约束。变量XI也可以取负值。始终可以将此类程序转换为定义44.1中考虑的类型。我们按以下步骤进行。
每个约束aix≥bi替换为约束−aix≤−bi。每个等式约束aix=bi都被两个约束aix≤bi和−aix≤−bi替换。
如果有n个变量Xi，我们创建n个新变量Yi和n新变量Zi，用Yi—Zi替换每个变量Xi。我们还增加了2n约束yi≥0和zi≥0。如果约束由不等式ax≤b给出，我们现在有约束由
.
我们将目标函数cx替换为cy-cz。
注：我们还表明，我们可以用等式约束ax=b替换不等式约束ax≤b，通过添加约束为非负的松弛变量。
